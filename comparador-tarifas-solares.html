<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <!-- CSP pragm√°tica para una p√°gina en evoluci√≥n constante: permite JSON-LD inline sin gestionar hashes. -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; base-uri 'self'; object-src 'none'; script-src 'self' 'wasm-unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; font-src 'self'; img-src 'self' data: https://luzfija.goatcounter.com; connect-src 'self' https://luzfija.goatcounter.com; worker-src 'self' blob:; form-action 'self';">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark light"/>
<meta name="description" content="Compara tarifas el√©ctricas con tus datos reales de autoconsumo solar. Sube tu CSV y descubre qu√© tarifa te ahorra m√°s con compensaci√≥n de excedentes y bater√≠a virtual.">
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Comparador Tarifas">

  <link rel="preconnect" href="https://luzfija.goatcounter.com">
  <script src="/js/config.js"></script>

  <meta property="og:title" content="Comparador de Tarifas Solares | An√°lisis con CSV | LuzFija">
  <meta property="og:description" content="Compara tarifas el√©ctricas con tus datos reales de autoconsumo solar. Sube tu CSV y descubre qu√© tarifa te ahorra m√°s con compensaci√≥n de excedentes y bater√≠a virtual.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://luzfija.es/comparador-tarifas-solares.html">
  <meta property="og:locale" content="es_ES">
  <meta property="og:site_name" content="LuzFija.es">
  <meta property="og:image" content="https://luzfija.es/og.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:alt" content="Comparador de Tarifas de Luz - Encuentra la m√°s barata en segundos">

  <!-- Logo para Google Search (marca) -->

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Comparador de Tarifas Solares | An√°lisis con CSV | LuzFija">
  <meta name="twitter:description" content="Compara tarifas el√©ctricas con tus datos reales de autoconsumo solar. Sube tu CSV y descubre qu√© tarifa te ahorra m√°s con compensaci√≥n de excedentes y bater√≠a virtual.">
  <meta name="twitter:image" content="https://luzfija.es/og.png">

  <link rel="canonical" href="https://luzfija.es/comparador-tarifas-solares.html">
  <link rel="alternate" hreflang="es-ES" href="https://luzfija.es/comparador-tarifas-solares.html">
  <link rel="alternate" hreflang="x-default" href="https://luzfija.es/comparador-tarifas-solares.html">


  <title>Comparador de Tarifas Solares | An√°lisis con CSV | LuzFija</title>
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "LuzFija.es",
    "url": "https://luzfija.es",
    "logo": "https://luzfija.es/logo-512.png",
    "description": "Comparador de tarifas el√©ctricas del mercado libre espa√±ol",
    "sameAs": ["https://github.com/almax-es/luzfija.es"],
    "contactPoint": {
      "@type": "ContactPoint",
      "contactType": "Customer Support",
      "email": "hola@luzfija.es"
    }
  }
  </script>

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Comparador de Tarifas Solares con An√°lisis CSV",
    "description": "Compara todas las tarifas el√©ctricas del mercado usando tus datos reales de autoconsumo solar (CSV). Calcula compensaci√≥n de excedentes, bater√≠a virtual y descubre qu√© tarifa te ahorra m√°s dinero cada mes.",
    "url": "https://luzfija.es/comparador-tarifas-solares.html",
    "logo": "https://luzfija.es/logo-512.png",
    "applicationCategory": "UtilitiesApplication",
    "operatingSystem": "Any",
    "inLanguage": "es",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "EUR"
    },
    "creator": {
      "@type": "Person",
      "name": "aLMaX"
    }
  }
  </script>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Inicio","item":"https://luzfija.es/"},
      {"@type":"ListItem","position":2,"name":"Comparador de Tarifas Solares","item":"https://luzfija.es/comparador-tarifas-solares.html"}
    ]
  }
  </script>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {
        "@type":"Question",
        "name":"¬øQu√© significan punta, llano y valle?",
        "acceptedAnswer":{"@type":"Answer","text":"Son periodos horarios con precios distintos en tarifas 3P. En general, punta es m√°s caro, valle m√°s barato y llano intermedio (los horarios exactos dependen del calendario y la tarifa)."}
      },
      {
        "@type":"Question",
        "name":"¬øQu√© es P1 y P2 en la potencia contratada?",
        "acceptedAnswer":{"@type":"Answer","text":"La potencia se paga por d√≠as y puede variar por periodo (P1/P2). En muchas viviendas se contrata la misma potencia en ambos, pero puedes optimizarla seg√∫n tu uso."}
      },
      {
        "@type":"Question",
        "name":"¬øEl comparador incluye impuestos?",
        "acceptedAnswer":{"@type":"Answer","text":"S√≠: el c√°lculo muestra potencia, consumo y una estimaci√≥n de impuestos/IVA seg√∫n el modelo del comparador."}
      },
      {
        "@type":"Question",
        "name":"¬øNecesito registrarme?",
        "acceptedAnswer":{"@type":"Answer","text":"No. Es una herramienta gratuita, sin registro. Puedes adem√°s compartir tu configuraci√≥n por URL."}
      },
      {
        "@type":"Question",
        "name":"¬øDe d√≥nde salen los precios?",
        "acceptedAnswer":{"@type":"Answer","text":"Las tarifas se recopilan de condiciones p√∫blicas de las comercializadoras y se actualizan regularmente. El PVPC se calcula diariamente desde los precios horarios oficiales de REE/ESIOS (indicador 1001)."}
      },
      {
        "@type":"Question",
        "name":"¬øQu√© es el PVPC?",
        "acceptedAnswer":{"@type":"Answer","text":"Es la tarifa regulada de electricidad en Espa√±a, con precios variables por periodos/horas seg√∫n el mercado."}
      },
      {
        "@type":"Question",
        "name":"¬øC√≥mo calcula el comparador el PVPC?",
        "acceptedAnswer":{"@type":"Answer","text":"Usa los datos que introduces (potencias P1/P2, d√≠as y consumos por periodos) y, cuando hay datos disponibles, muestra un PVPC estimado y lo incluye en el ranking."}
      },
      {
        "@type":"Question",
        "name":"¬øC√≥mo funciona con placas solares y autoconsumo?",
        "acceptedAnswer":{"@type":"Answer","text":"El comparador analiza tus datos reales de autoconsumo (CSV) y calcula mes a mes la compensaci√≥n de excedentes seg√∫n el precio de cada comercializadora. Para tarifas con Bater√≠a Virtual (BV), los excedentes sobrantes se acumulan en euros para descontarlos en meses futuros. El ranking ordena todas las tarifas del mercado por ahorro real, mostrando cu√°nto pagar√≠as con cada una y qu√© saldo BV acumular√≠as."}
      }
    ]
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "LuzFija.es",
    "alternateName": "Luzfija",
    "url": "https://luzfija.es",
    "logo": {
      "@type": "ImageObject",
      "url": "https://luzfija.es/logo-512.png",
      "width": 512,
      "height": 512,
      "caption": "LuzFija.es - Comparador de Tarifas El√©ctricas"
    },
    "description": "Comparador gratuito de tarifas de luz en Espa√±a. Calcula tu factura con discriminaci√≥n horaria, placas solares y PVPC.",
    "email": "hola@luzfija.es",
    "foundingDate": "2023",
    "sameAs": [
      "https://luzfija.es"
    ],
    "contactPoint": {
      "@type": "ContactPoint",
      "contactType": "customer support",
      "email": "hola@luzfija.es",
      "availableLanguage": ["es"]
    },
    "areaServed": {
      "@type": "Country",
      "name": "Espa√±a"
    },
    "serviceType": "Comparador de tarifas el√©ctricas"
  }
  </script>

  <script src="/js/theme.js"></script>

    <link rel="stylesheet" href="/styles.css">
  <!-- CSS del desglose (solo se usa al abrir el modal). Se carga sin bloquear el render inicial -->
  <link rel="preload" href="/desglose-factura.css" as="style">
  <link rel="stylesheet" href="/desglose-factura.css" media="all">
  <noscript><link rel="stylesheet" href="/desglose-factura.css"></noscript>

  <!-- PDF.js se carga din√°micamente cuando el usuario sube una factura (ver factura.js) -->
  <link rel="preload" href="/fonts/outfit-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="/bv-sim.css">

    <meta name="theme-color" content="#8B5CF6">
</head>

<body>
  <a class="skip-link" href="#main">Saltar al contenido</a>
<div class="container">
    <div class="topbar">
      <div class="brand">
        <span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span>
        <div class="logo" aria-hidden="true" onclick="window.location.href='/'" style="cursor:pointer">
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;">
            <!-- ... (logo content matches original) ... -->
            <defs>
              <linearGradient id="logoGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1">
                  <animate attributeName="stop-color" values="#fbbf24;#f59e0b;#fbbf24" dur="2s" repeatCount="indefinite"/>
                </stop>
                <stop offset="50%" style="stop-color:#f59e0b;stop-opacity:1"/>
                <stop offset="100%" style="stop-color:#fbbf24;stop-opacity:1">
                  <animate attributeName="stop-color" values="#fbbf24;#f59e0b;#fbbf24" dur="2s" repeatCount="indefinite"/>
                </stop>
              </linearGradient>
              <linearGradient id="logoGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1"/>
                <stop offset="100%" style="stop-color:#6366f1;stop-opacity:1"/>
              </linearGradient>
              <filter id="glow">
                <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                <feMerge>
                  <feMergeNode in="coloredBlur"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
            </defs>
            <circle cx="50" cy="50" r="35" fill="url(#logoGrad2)" opacity="0.2">
              <animate attributeName="r" values="35;38;35" dur="2s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.2;0.4;0.2" dur="2s" repeatCount="indefinite"/>
            </circle>
            <path d="M 55 15 L 35 48 L 48 48 L 45 85 L 70 45 L 57 45 Z"
                  fill="url(#logoGrad1)" filter="url(#glow)"
                  stroke="#fff" stroke-width="1.5" stroke-linejoin="round">
              <animateTransform attributeName="transform" attributeType="XML" type="scale"
                                values="1;1.08;1" dur="1.5s" repeatCount="indefinite" additive="sum"/>
            </path>
            <circle cx="30" cy="30" r="2" fill="#fbbf24" opacity="0">
              <animate attributeName="opacity" values="0;1;0" dur="1.5s" repeatCount="indefinite"/>
              <animate attributeName="r" values="2;3;2" dur="1.5s" repeatCount="indefinite"/>
            </circle>
            <circle cx="70" cy="35" r="2" fill="#fbbf24" opacity="0">
              <animate attributeName="opacity" values="0;1;0" dur="1.5s" begin="0.5s" repeatCount="indefinite"/>
              <animate attributeName="r" values="2;3;2" dur="1.5s" begin="0.5s" repeatCount="indefinite"/>
            </circle>
            <circle cx="65" cy="70" r="2" fill="#fbbf24" opacity="0">
              <animate attributeName="opacity" values="0;1;0" dur="1.5s" begin="1s" repeatCount="indefinite"/>
              <animate attributeName="r" values="2;3;2" dur="1.5s" begin="1s" repeatCount="indefinite"/>
            </circle>
          </svg>
        </div>
        <div>
          <nav aria-label="Breadcrumb" class="u-mb-8">
            <ol class="breadcrumb">
              <li><a href="/" style="text-decoration:none; font-weight:bold;">&larr; Volver al Comparador</a></li>
            </ol>
          </nav>
                    <h1>Comparador de Tarifas Solares <span class="bv-csv-badge">CSV</span></h1>
                    <p>Analiza tus datos reales de autoconsumo (CSV/Excel) y descubre qu√© tarifa te ahorra m√°s dinero</p>
                  </div>
                </div>
          
                      <div class="actions">
                        <div class="actions-right" style="margin-left: auto; display: flex; gap: 8px;">
                          <button class="btn" id="btnTheme" type="button" title="Cambiar tema" aria-label="Cambiar tema">‚òÄÔ∏è</button>                    <div class="menu" id="menuRoot">
                      <button class="btn" id="btnMenu" type="button" aria-haspopup="menu" aria-controls="menuPanel" aria-expanded="false" title="Opciones" aria-label="Abrir men√∫ de opciones">‚öôÔ∏è</button>
                      <div class="menuPanel" id="menuPanel" role="menu" aria-label="Opciones" aria-orientation="vertical">
                        <div class="menuHint">Opciones</div>
                        <a class="menuItem u-no-underline" href="mailto:hola@luzfija.es" role="menuitem">
                          <span class="mi-left">‚úâÔ∏è Contacto</span>
                          <span class="mi-right">email</span>
                        </a>
                        <div class="menuDivider"></div>
                        <button class="menuItem" id="btnClearCache" type="button" role="menuitem" aria-label="Limpiar cach√©">
                          <span class="mi-left">üóëÔ∏è Limpiar cach√©</span>
                          <span class="mi-right">web</span>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
          
              <main id="main" tabindex="-1">
                <section class="card">
                  <div class="head">
                    <div class="kicker">An√°lisis Avanzado con CSV</div>
                    <div class="title">Autoconsumo y Excedentes Solares</div>
                  </div>
                  <div class="body">
                    <p style="margin-bottom: 24px; color:var(--muted); font-size: 0.95rem;">
                      Sube tu CSV con datos reales de consumo y excedentes, o introduce los datos manualmente. Compara todas las tarifas y descubre cu√°l te ahorra m√°s con compensaci√≥n solar y bater√≠a virtual.
                    </p>

                    <!-- Selector de M√©todo -->
                    <div style="display: flex; gap: 8px; margin-bottom: 24px;">
                      <button type="button" id="method-csv" class="btn active" style="flex: 1; justify-content: center; border-radius: 99px;">üìÅ Subir CSV</button>
                      <button type="button" id="method-manual" class="btn" style="flex: 1; justify-content: center; border-radius: 99px;">‚úçÔ∏è Entrada Manual</button>
                    </div>
          
                    <div class="bv-form-container">
                      <!-- Inputs Comunes (Izquierda) -->
                      <div class="form" style="grid-template-columns: 1fr 1fr; gap: 16px;">
                        
                        <div class="group">
                          <label for="bv-p1">Potencia P1 (kW)</label>
                          <input class="input" type="text" id="bv-p1" inputmode="decimal" value="3,45" placeholder="Ej: 3,45">
                        </div>

                        <div class="group">
                          <label for="bv-p2">Potencia P2 (kW)</label>
                          <input class="input" type="text" id="bv-p2" inputmode="decimal" value="3,45" placeholder="Ej: 3,45">
                        </div>

                        <div class="group" style="grid-column: 1 / -1;">
                          <label for="bv-saldo-inicial">Saldo en Hucha (‚Ç¨)</label>
                          <input class="input" type="text" id="bv-saldo-inicial" inputmode="decimal" value="0,00" placeholder="0,00">
                          <div style="font-size:11px; color:var(--muted); margin-top:4px;">Si ya tienes dinero acumulado de meses anteriores.</div>
                        </div>

                        <div class="group" style="grid-column: 1 / -1;">
                          <label for="bv-zona-fiscal">Zona Fiscal</label>
                          <select id="bv-zona-fiscal" class="input">
                            <option value="Pen√≠nsula">Pen√≠nsula y Baleares</option>
                            <option value="Canarias">Canarias</option>
                            <option value="CeutaMelilla">Ceuta y Melilla</option>
                          </select>
                        </div>

                        <div class="group" id="bv-vivienda-canarias-wrapper" style="grid-column: 1 / -1; display:none;">
                          <label class="fv-check">
                            <input id="bv-vivienda-canarias" type="checkbox" checked>
                            <span>Es Vivienda (IGIC 0%)</span>
                          </label>
                        </div>

                        <!-- Tarifa Actual (Opcional) -->
                        <div style="grid-column: 1 / -1; margin-top: 12px;">
                          <details class="seoDetails" style="background: rgba(255,255,255,0.03); border: 1px dashed var(--border);">
                            <summary style="font-size: 13px; padding: 10px;">‚≠ê Comparar con mi tarifa actual</summary>
                            <div style="padding: 16px; display: grid; gap: 16px;">

                              <!-- Info box explicativo -->
                              <div class="info-box">
                                <div style="display: flex; align-items: start; gap: 10px;">
                                  <span style="font-size: 18px; flex-shrink: 0;">üí°</span>
                                  <div>
                                    <strong style="display: block; margin-bottom: 4px;">Busca estos precios en tu factura</strong>
                                    <div style="color: var(--muted2); font-size: 11px; line-height: 1.5;">
                                      Normalmente aparecen en la secci√≥n de "Detalle del importe" o "T√©rminos de facturaci√≥n"
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <!-- T√©rmino de Potencia -->
                              <div class="mt-seccion-header">
                                <span class="mt-seccion-icon">üìä</span>
                                <h4 class="mt-seccion-title">T√©rmino de potencia</h4>
                                <span class="mt-seccion-subtitle">Precio por kW contratado/d√≠a</span>
                              </div>
                              <div class="form" style="grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div class="group">
                                  <label for="mtP1">Potencia P1 (‚Ç¨/kW¬∑d√≠a)</label>
                                  <input id="mtP1" class="input" type="text" inputmode="decimal" placeholder="Ej: 0,0891">
                                </div>
                                <div class="group">
                                  <label for="mtP2">Potencia P2 (‚Ç¨/kW¬∑d√≠a)</label>
                                  <input id="mtP2" class="input" type="text" inputmode="decimal" placeholder="Ej: 0,0445">
                                </div>
                              </div>

                              <!-- T√©rmino de Energ√≠a -->
                              <div class="mt-seccion-header" style="margin-top: 4px;">
                                <span class="mt-seccion-icon">‚ö°</span>
                                <h4 class="mt-seccion-title">T√©rmino de energ√≠a</h4>
                                <span class="mt-seccion-subtitle">Precio por kWh consumido</span>
                              </div>
                              <div class="form" style="grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                                <div class="group">
                                  <label for="mtPunta">Punta (‚Ç¨/kWh)</label>
                                  <input id="mtPunta" class="input" type="text" inputmode="decimal" placeholder="Ej: 0,1543">
                                </div>
                                <div class="group">
                                  <label for="mtLlano">Llano (‚Ç¨/kWh)</label>
                                  <input id="mtLlano" class="input" type="text" inputmode="decimal" placeholder="Ej: 0,1234">
                                </div>
                                <div class="group">
                                  <label for="mtValle">Valle (‚Ç¨/kWh)</label>
                                  <input id="mtValle" class="input" type="text" inputmode="decimal" placeholder="Ej: 0,0899">
                                </div>
                              </div>

                              <!-- Compensaci√≥n de Excedentes -->
                              <div class="mt-seccion-header" style="margin-top: 4px;">
                                <span class="mt-seccion-icon">‚òÄÔ∏è</span>
                                <h4 class="mt-seccion-title">Compensaci√≥n de excedentes</h4>
                                <span class="mt-seccion-subtitle">Precio que te pagan por verter a la red</span>
                              </div>
                              <div class="group">
                                <label for="mtExc">Precio compensaci√≥n (‚Ç¨/kWh)</label>
                                <input id="mtExc" class="input" type="text" inputmode="decimal" placeholder="Ej: 0,0743">
                              </div>

                              <div class="group" style="margin-top: 8px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; user-select: none;">
                                  <input id="mtBV" type="checkbox" style="width: auto; cursor: pointer;">
                                  <span style="font-size: 13px;">Tiene bater√≠a virtual (acumula excedentes no compensados)</span>
                                </label>
                              </div>

                            </div>
                          </details>
                        </div>

                      </div>
          
                      <!-- Dynamic Zone (Derecha) -->
                      <div id="bv-input-zone" style="height: 100%;">
                        <!-- Upload Zone -->
                        <div class="bv-upload-zone" id="drop-zone" role="button" tabindex="0" aria-label="Subir archivo CSV o Excel">
                          <input class="bv-file-input" type="file" id="bv-file" accept=".csv,.xlsx,.xls,text/csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel" style="display:none">
                          <div class="bv-upload-content">
                            <div class="bv-upload-icon">üìÑ</div>
                            <p class="bv-upload-text">Arrastra tu CSV aqu√≠</p>
                            <p class="bv-upload-hint">Soporta Datadis, Distribuidoras, Iberdrola y Excel</p>
                          </div>
                          <div class="bv-file-selected" id="file-selected-msg" style="display:none">
                            <span class="bv-file-name" id="file-name">archivo.csv</span>
                            <button type="button" class="bv-remove-file" id="remove-file" aria-label="Eliminar archivo">‚úï</button>
                          </div>
                        </div>

                        <!-- Manual Entry (Oculto por defecto) -->
                        <div id="bv-manual-zone" style="display:none; height: 100%;">
                          <div class="card" style="margin:0; height: 100%; border-style: dashed; background: var(--card2);">
                            <div class="body" style="padding: 12px; height: 100%; display: flex; flex-direction: column;">
                              <!-- Header con tooltips descriptivos -->
                              <div class="bv-manual-header">
                                <span>Mes</span>
                                <span title="Consumo en periodo Punta (10-14h y 18-22h laborables)">C. Punta (kWh)</span>
                                <span title="Consumo en periodo Llano (8-10h, 14-18h, 22-24h laborables)">C. Llano (kWh)</span>
                                <span title="Consumo en periodo Valle (0-8h + fines de semana y festivos)">C. Valle (kWh)</span>
                                <span title="Excedentes vertidos a la red (kWh)">Vertido</span>
                              </div>
                              <div id="bv-manual-grid" style="display: block; overflow-y: auto; flex: 1; padding-right: 4px;">
                                <!-- Se generar√° por JS -->
                              </div>

                              <!-- Fila de totales detallados (dentro del grid visualmente) -->
                              <div id="bv-manual-totals-row" class="bv-manual-totals-row" style="display: none;">
                                <span style="font-weight: 900; color: var(--accent);">TOTAL</span>
                                <span id="bv-total-p1" style="font-weight: 700;">0</span>
                                <span id="bv-total-p2" style="font-weight: 700;">0</span>
                                <span id="bv-total-p3" style="font-weight: 700;">0</span>
                                <span id="bv-total-vert" style="font-weight: 700;">0</span>
                              </div>

                              <!-- Totales generales (consumo + excedentes) -->
                              <div id="bv-manual-totals-summary" style="display: none; margin-top: 12px; padding: 10px; background: rgba(139, 92, 246, 0.1); border-radius: 8px; border: 1px solid rgba(139, 92, 246, 0.3);">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; font-size: 12px;">
                                  <div>
                                    <div style="color: var(--muted); margin-bottom: 4px;">Consumo total anual</div>
                                    <div style="font-size: 16px; font-weight: 700; color: var(--accent);">
                                      <span id="bv-total-consumo">0</span> kWh
                                    </div>
                                  </div>
                                  <div>
                                    <div style="color: var(--muted); margin-bottom: 4px;">Excedentes total anual</div>
                                    <div style="font-size: 16px; font-weight: 700; color: var(--accent);">
                                      <span id="bv-total-excedentes">0</span> kWh
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div style="margin-top: 10px; display: flex; justify-content: space-between; align-items: center; gap: 8px; flex-wrap: wrap;">
                                <div style="font-size: 11px; color: var(--muted); line-height: 1.3;">
                                  <span id="bv-save-indicator" class="bv-save-indicator"></span>
                                  <div style="margin-top: 4px;">Rellena solo los meses que quieras simular (ej: marzo a noviembre).</div>
                                </div>
                                <button type="button" id="bv-reset-manual" class="bv-reset-btn">‚Üª Borrar todo</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                    </div>
          
                    <div class="u-mt-24">
                      <button class="btn primary" id="bv-simulate" type="button">
                        <span class="bv-btn-text" style="font-size: 1.1rem;">Comparar Tarifas y Ver Ahorro &rarr;</span>
                        <span class="spinner" style="display:none"></span>
                      </button>
                    </div>
                  </div>
                </section>
          
                <!-- Resultados (Ocultos por defecto) -->
                <div id="bv-results-container" class="fade-container" style="display:none">
                  <section class="card u-mt-16">
                    <div id="bv-results"></div>
                  </section>
                </div>
          
                <!-- Estado (Oculto por defecto o integrado en notificaciones) -->
                <div id="bv-status-container" style="display:none">
                  <section class="card u-mt-16">
                    <div class="head">
                      <h2>Estado</h2>
                    </div>
                    <div id="bv-status"></div>
                  </section>
                </div>
              </main>
          
              <footer class="footer-container">
                <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(240px, 1fr)); gap:30px; margin-bottom:30px;">
                          <div>
                            <h3 class="u-h3-strong-10">Sobre el Comparador</h3>
                            <p style="color:var(--muted); font-size:12px; line-height:1.6; margin:0 0 12px 0;">
                              Herramienta avanzada para <strong>comparar tarifas solares</strong> usando tus datos reales de autoconsumo y excedentes.
                            </p>
                            <p class="u-m-0">
                              <a href="/guias.html" style="color:var(--accent); font-weight:700; text-decoration:none; display:inline-flex; align-items:center; gap:6px; font-size:13px; transition: opacity 0.2s;">
                                üìö Gu√≠as sobre tarifas el√©ctricas
                                <span style="font-size:10px;">‚Üí</span>
                              </a>
                            </p>
                          </div>
                  
                          <div>
                            <h3 class="u-h3-strong-10">Horarios Discriminaci√≥n</h3>
                            <ul class="u-list-muted-12">
                              <li><strong style="color:var(--danger);">Punta:</strong> 10h-14h y 18h-22h</li>
                              <li><strong style="color:var(--warn);">Llano:</strong> 8h-10h, 14h-18h, 22h-24h</li>
                              <li><strong style="color:var(--accent2);">Valle:</strong> 0h-8h + fines de semana</li>
                            </ul>
                          </div>
                  
                          <div>
                            <h3 class="u-h3-strong-10">¬øQu√© Analizamos?</h3>
                            <ul class="u-list-muted-12">
                              <li>‚úì Todas las tarifas del mercado</li>
                              <li>‚úì Compensaci√≥n de excedentes (‚Ç¨)</li>
                              <li>‚úì Bater√≠a Virtual (acumulaci√≥n)</li>
                              <li>‚úì PVPC regulada (datos REE)</li>
                              <li>‚úì Ranking por ahorro real mensual</li>
                            </ul>
                          </div>
                  
                          <div id="contacto">
                            <h3 class="u-h3-strong-10">Contacto</h3>
                            <div class="contact-box">
                              <div class="u-label-xs">‚úâÔ∏è Email</div>
                              <a href="mailto:hola@luzfija.es" class="u-color-accent u-fw-900 u-text-13" style="text-decoration:underline;">hola@luzfija.es</a>
                            </div>
                          </div>
                        </div>
                  
                        <div style="margin-top:30px; padding:28px 20px 24px; border-top:1px solid rgba(255,255,255,0.05); text-align:center;">
                          <p style="font-size:11px; opacity:0.5; margin-bottom:8px;">‚ö° LuzFija.es ¬∑ Comparador de Tarifas Solares</p>
                          <p class="u-text-10 u-opacity-40">Proyecto gratuito y sin publicidad ¬∑ Tarifas actualizadas regularmente</p>
                  
                          <div style="margin-top:18px; padding-top:14px; border-top:1px solid var(--border);">
                            <div class="u-max-w-720 u-center-text-padded">
                              <p class="u-mt-10 u-text-10 u-opacity-65 u-leading-15">
                                Anal√≠tica sin cookies ¬∑ <a href="/privacidad.html" class="u-link-accent">Pol√≠tica de privacidad</a> ¬∑ <a href="/aviso-legal.html" class="u-link-accent">Aviso legal</a>
                              </p>
                              <div class="footer-credits">Desarrollado por <a href="https://github.com/almax-es" target="_blank" rel="noopener noreferrer" style="color:inherit; text-decoration:none; font-weight:600;">aLMaX</a></div>
                            </div>
                          </div>
                        </div>              </footer>
            </div>
          
            <div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true"><span class="dot" id="toastDot"></span><span id="toastText"></span></div>
          
            <script src="/js/lf-config.js"></script>
            <script src="/js/lf-utils.js"></script>
            <script src="/js/bv/bv-import.js"></script>
            <script src="/js/bv/bv-sim-monthly.js"></script>
            <script src="/js/bv/bv-ui.js"></script>
          </body></html>
